basePath: /api/v1
definitions:
  controller_handler.AbortMultipartUploadRequest:
    properties:
      key:
        type: string
      uploadId:
        type: string
    required:
    - key
    - uploadId
    type: object
  controller_handler.ChunkedUploadForTaskRequest:
    properties:
      address:
        example: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa
        type: string
      chunkPreTxHex:
        example: 0100000...
        type: string
      content:
        type: string
      contentType:
        example: image/jpeg
        type: string
      feeRate:
        example: 1
        type: integer
      fileName:
        example: example.jpg
        type: string
      indexPreTxHex:
        example: 0100000...
        type: string
      mergeTxHex:
        example: 0100000...
        type: string
      metaId:
        example: metaid_abc123
        type: string
      operation:
        example: create
        type: string
      path:
        example: /file
        type: string
      storageKey:
        type: string
    required:
    - address
    - chunkPreTxHex
    - fileName
    - indexPreTxHex
    - metaId
    - path
    type: object
  controller_handler.ChunkedUploadRequest:
    properties:
      address:
        example: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa
        type: string
      chunkPreTxHex:
        example: 0100000...
        type: string
      content:
        type: string
      contentType:
        example: image/jpeg
        type: string
      feeRate:
        example: 1
        type: integer
      fileName:
        example: example.jpg
        type: string
      indexPreTxHex:
        example: 0100000...
        type: string
      isBroadcast:
        example: false
        type: boolean
      mergeTxHex:
        example: 0100000...
        type: string
      metaId:
        example: metaid_abc123
        type: string
      operation:
        example: create
        type: string
      path:
        example: /file
        type: string
      storageKey:
        type: string
    required:
    - address
    - chunkPreTxHex
    - fileName
    - indexPreTxHex
    - metaId
    - path
    type: object
  controller_handler.CommitUploadRequest:
    properties:
      fileId:
        example: metaid_abc123
        type: string
      signedRawTx:
        example: 0100000...
        type: string
    required:
    - fileId
    - signedRawTx
    type: object
  controller_handler.CommitUploadResponseData:
    properties:
      fileId:
        example: metaid_abc123
        type: string
      message:
        example: success
        type: string
      pinId:
        example: abc123...i0
        type: string
      status:
        example: success
        type: string
      txId:
        example: abc123...
        type: string
    type: object
  controller_handler.CompleteMultipartUploadRequest:
    properties:
      key:
        type: string
      parts:
        items:
          properties:
            etag:
              type: string
            partNumber:
              type: integer
            size:
              type: integer
          type: object
        type: array
      uploadId:
        type: string
    required:
    - key
    - parts
    - uploadId
    type: object
  controller_handler.ConfigResponse:
    properties:
      maxFileSize:
        example: 10485760
        type: integer
      swaggerBaseUrl:
        example: localhost:7282
        type: string
    type: object
  controller_handler.EstimateChunkedUploadRequest:
    properties:
      content:
        type: string
      contentType:
        example: image/jpeg
        type: string
      feeRate:
        example: 1
        type: integer
      fileName:
        example: example.jpg
        type: string
      path:
        example: /file
        type: string
      storageKey:
        type: string
    required:
    - fileName
    - path
    type: object
  controller_handler.InitiateMultipartUploadRequest:
    properties:
      address:
        description: Optional, user address
        type: string
      fileName:
        type: string
      fileSize:
        type: integer
      metaId:
        description: Optional, for file organization
        type: string
    required:
    - fileName
    - fileSize
    type: object
  controller_handler.ListPartsRequest:
    properties:
      key:
        type: string
      uploadId:
        type: string
    required:
    - key
    - uploadId
    type: object
  controller_handler.PreUploadResponseData:
    properties:
      calTxFee:
        example: 1000
        type: integer
      calTxSize:
        example: 500
        type: integer
      fileId:
        example: metaid_abc123
        type: string
      fileMd5:
        example: 5d41402abc4b2a76b9719d911017c592
        type: string
      filehash:
        example: 2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae
        type: string
      message:
        example: success
        type: string
      pinId:
        example: abc123...i0
        type: string
      preTxRaw:
        example: 0100000...
        type: string
      status:
        example: pending
        type: string
      txId:
        example: abc123...
        type: string
    type: object
  controller_handler.UploadPartRequest:
    properties:
      content:
        description: Base64 encoded part data
        type: string
      key:
        description: Storage key from initiate
        type: string
      partNumber:
        type: integer
      uploadId:
        type: string
    required:
    - content
    - key
    - partNumber
    - uploadId
    type: object
  meta-file-system_controller_respond.ChunkedUploadTaskResponse:
    properties:
      message:
        example: task created
        type: string
      status:
        example: pending
        type: string
      taskId:
        example: task_123
        type: string
    type: object
  meta-file-system_controller_respond.Response:
    description: Unified API response structure
    properties:
      code:
        example: 0
        type: integer
      data: {}
      message:
        example: success
        type: string
      processingTime:
        example: 123
        type: integer
    type: object
  meta-file-system_controller_respond.UploadTask:
    properties:
      address:
        type: string
      chunkFundingTx:
        type: string
      chunkTxIds:
        items:
          type: string
        type: array
      contentType:
        type: string
      createdAt:
        type: string
      currentStep:
        type: string
      errorMessage:
        type: string
      fileHash:
        type: string
      fileId:
        type: string
      fileMd5:
        type: string
      fileName:
        type: string
      fileSize:
        type: integer
      finishedAt:
        type: string
      indexTxId:
        type: string
      metaId:
        type: string
      operation:
        type: string
      path:
        type: string
      processedChunks:
        type: integer
      progress:
        type: integer
      stage:
        type: string
      startedAt:
        type: string
      status:
        type: string
      taskId:
        type: string
      totalChunks:
        type: integer
      updatedAt:
        type: string
    type: object
  meta-file-system_controller_respond.UploadTaskDetailResponse:
    properties:
      task:
        $ref: '#/definitions/meta-file-system_controller_respond.UploadTask'
    type: object
  meta-file-system_controller_respond.UploadTaskListResponse:
    properties:
      hasMore:
        example: true
        type: boolean
      nextCursor:
        example: 123
        type: integer
      tasks:
        items:
          $ref: '#/definitions/meta-file-system_controller_respond.UploadTask'
        type: array
    type: object
  meta-file-system_service_upload_service.ChunkedUploadResponse:
    properties:
      chunkFundingTx:
        description: Funding transaction for chunk outputs
        type: string
      chunkNumber:
        description: Number of chunks
        type: integer
      chunkTxIds:
        description: Chunk transaction IDs (ordered)
        items:
          type: string
        type: array
      chunkTxs:
        description: Chunk transaction hex list (ordered)
        items:
          type: string
        type: array
      fileHash:
        description: File SHA256 hash
        type: string
      fileId:
        description: File ID
        type: string
      fileMd5:
        description: File MD5 hash
        type: string
      indexTx:
        description: Index transaction hex
        type: string
      indexTxId:
        description: Index transaction ID
        type: string
      message:
        description: Additional message
        type: string
      status:
        description: Status string
        type: string
    type: object
  meta-file-system_service_upload_service.CompleteMultipartUploadResponse:
    properties:
      fileSize:
        description: Total file size
        type: integer
      key:
        description: Storage key
        type: string
      uploadId:
        description: Upload ID
        type: string
    type: object
  meta-file-system_service_upload_service.EstimateChunkedUploadResponse:
    properties:
      chunkFees:
        description: Fee per chunk
        items:
          type: integer
        type: array
      chunkNumber:
        description: Number of chunks
        type: integer
      chunkPerTxFee:
        description: Fee required per chunk transaction
        type: integer
      chunkPreTxFee:
        description: Total funding required for chunk transactions
        type: integer
      chunkSize:
        description: Chunk size in bytes
        type: integer
      indexPreTxFee:
        description: Funding required for the index transaction
        type: integer
      message:
        description: Additional message
        type: string
      perChunkFee:
        description: Average fee per chunk
        type: integer
      totalFee:
        description: Total fee (ChunkPreTxFee + IndexPreTxFee)
        type: integer
    type: object
  meta-file-system_service_upload_service.InitiateMultipartUploadResponse:
    properties:
      key:
        description: Storage key
        type: string
      uploadId:
        description: Upload ID for subsequent operations
        type: string
    type: object
  meta-file-system_service_upload_service.ListPartsResponse:
    properties:
      parts:
        items:
          $ref: '#/definitions/storage.PartInfo'
        type: array
      uploadId:
        type: string
    type: object
  meta-file-system_service_upload_service.UploadPartResponse:
    properties:
      etag:
        description: ETag for this part
        type: string
      partNumber:
        description: Part number
        type: integer
    type: object
  storage.PartInfo:
    properties:
      etag:
        type: string
      partNumber:
        type: integer
      size:
        type: integer
    type: object
host: localhost:7282
info:
  contact:
    email: support@swagger.io
    name: API Support
    url: http://www.swagger.io/support
  description: Meta File System Upload Service API, provides file upload functionality
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: Meta File System Uploader API
  version: "1.0"
paths:
  /config:
    get:
      consumes:
      - application/json
      description: Get upload service configuration information, including max file
        size and swagger base URL
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.ConfigResponse'
              type: object
      summary: Get configuration
      tags:
      - Configuration
  /files/chunked-upload:
    post:
      consumes:
      - application/json
      description: Upload large file by splitting it into chunks, build transactions
        for chunks and index, optionally broadcast all transactions in order
      parameters:
      - description: Chunked upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.ChunkedUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Upload successful
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.ChunkedUploadResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Chunked file upload
      tags:
      - File Upload
  /files/chunked-upload-task:
    post:
      consumes:
      - application/json
      description: Create an async chunked upload task and return the task ID so the
        client can poll for progress
      parameters:
      - description: Async chunked upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.ChunkedUploadForTaskRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_controller_respond.ChunkedUploadTaskResponse'
              type: object
        "400":
          description: Invalid parameter
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Async chunked upload (create task)
      tags:
      - File Upload
  /files/commit-upload:
    post:
      consumes:
      - application/json
      description: Submit signed transaction for broadcast
      parameters:
      - description: Commit upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.CommitUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Upload successful, return transaction ID and Pin ID
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.CommitUploadResponseData'
              type: object
        "400":
          description: Parameter error or file not found
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error or broadcast failed
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Commit upload
      tags:
      - File Upload
  /files/direct-upload:
    post:
      consumes:
      - multipart/form-data
      description: Upload file and add MetaID OP_RETURN output to existing PreTxHex,
        then broadcast immediately. This is a one-step upload process that combines
        building and broadcasting. Supports UTXO merge transaction for SIGHASH_SINGLE
        compatibility.
      parameters:
      - description: File to upload
        in: formData
        name: file
        required: true
        type: file
      - description: File path
        in: formData
        name: path
        required: true
        type: string
      - description: Pre-transaction hex (signed, with inputs and outputs)
        in: formData
        name: preTxHex
        required: true
        type: string
      - description: Merge transaction hex (optional, broadcasted before main transaction)
        in: formData
        name: mergeTxHex
        type: string
      - default: create
        description: Operation type
        in: formData
        name: operation
        type: string
      - description: Content type
        in: formData
        name: contentType
        type: string
      - description: MetaID
        in: formData
        name: metaId
        type: string
      - description: Address (also used as change address if changeAddress is not
          provided)
        in: formData
        name: address
        type: string
      - description: Change address (optional, defaults to address)
        in: formData
        name: changeAddress
        type: string
      - description: Fee rate (satoshis per byte, optional)
        in: formData
        name: feeRate
        type: integer
      - description: Total input amount in satoshis (optional, for automatic change
          calculation)
        in: formData
        name: totalInputAmount
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Upload successful, return transaction ID and Pin ID
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.CommitUploadResponseData'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Direct upload file (one-step)
      tags:
      - File Upload
  /files/estimate-chunked-upload:
    post:
      consumes:
      - application/json
      description: Estimate the fee required for chunked file upload, including chunk
        count and fees for ChunkPreTxHex and IndexPreTxHex
      parameters:
      - description: Estimate chunked upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.EstimateChunkedUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Estimate successful
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.EstimateChunkedUploadResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Estimate chunked upload fee
      tags:
      - File Upload
  /files/multipart/abort:
    post:
      consumes:
      - application/json
      description: Abort a multipart upload session and clean up resources
      parameters:
      - description: Abort multipart upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.AbortMultipartUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Abort successful
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Abort multipart upload
      tags:
      - File Upload
  /files/multipart/complete:
    post:
      consumes:
      - application/json
      description: Complete a multipart upload session and merge all parts into a
        single file
      parameters:
      - description: Complete multipart upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.CompleteMultipartUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.CompleteMultipartUploadResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Complete multipart upload
      tags:
      - File Upload
  /files/multipart/initiate:
    post:
      consumes:
      - application/json
      description: Start a multipart upload session for large file uploads with resume
        support
      parameters:
      - description: Initiate multipart upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.InitiateMultipartUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.InitiateMultipartUploadResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Initiate multipart upload
      tags:
      - File Upload
  /files/multipart/list-parts:
    post:
      consumes:
      - application/json
      description: List all uploaded parts in a multipart upload session for resume
        support
      parameters:
      - description: List parts request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.ListPartsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.ListPartsResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: List uploaded parts
      tags:
      - File Upload
  /files/multipart/upload-part:
    post:
      consumes:
      - application/json
      description: Upload a single part of the file in a multipart upload session
      parameters:
      - description: Upload part request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.UploadPartRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.UploadPartResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Upload part
      tags:
      - File Upload
  /files/pre-upload:
    post:
      consumes:
      - multipart/form-data
      description: Upload file and generate unsigned transaction, return transaction
        for client signing
      parameters:
      - description: File to upload
        in: formData
        name: file
        required: true
        type: file
      - description: File path
        in: formData
        name: path
        required: true
        type: string
      - default: create
        description: Operation type
        in: formData
        name: operation
        type: string
      - description: Content type
        in: formData
        name: contentType
        type: string
      - description: Change address
        in: formData
        name: changeAddress
        type: string
      - description: MetaID
        in: formData
        name: metaId
        type: string
      - description: Address
        in: formData
        name: address
        type: string
      - default: 1
        description: Fee rate
        in: formData
        name: feeRate
        type: integer
      - description: Output list json
        in: formData
        name: outputs
        type: string
      - description: Other output list json
        in: formData
        name: otherOutputs
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Pre-upload successful, return transaction and file info
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.PreUploadResponseData'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Pre-upload file
      tags:
      - File Upload
  /files/task/{taskId}:
    get:
      consumes:
      - application/json
      description: Get async upload task progress and status by task ID
      parameters:
      - description: Task ID
        in: path
        name: taskId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_controller_respond.UploadTaskDetailResponse'
              type: object
        "400":
          description: Invalid parameter
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "404":
          description: Task not found
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Query task progress
      tags:
      - File Upload
  /files/tasks:
    get:
      consumes:
      - application/json
      description: List chunked upload tasks for a given address with cursor-based
        pagination
      parameters:
      - description: User address
        in: query
        name: address
        required: true
        type: string
      - default: 0
        description: Cursor (last task ID)
        in: query
        name: cursor
        type: integer
      - default: 20
        description: Page size
        in: query
        name: size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_controller_respond.UploadTaskListResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: List upload tasks
      tags:
      - File Upload
schemes:
- https
- http
swagger: "2.0"
