basePath: /api/v1
definitions:
  controller_handler.ChunkedUploadRequest:
    properties:
      address:
        example: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa
        type: string
      chunkPreTxHex:
        example: 0100000...
        type: string
      content:
        type: string
      contentType:
        example: image/jpeg
        type: string
      feeRate:
        example: 1
        type: integer
      fileName:
        example: example.jpg
        type: string
      indexPreTxHex:
        example: 0100000...
        type: string
      isBroadcast:
        example: false
        type: boolean
      metaId:
        example: metaid_abc123
        type: string
      operation:
        example: create
        type: string
      path:
        example: /file
        type: string
    required:
    - address
    - chunkPreTxHex
    - content
    - fileName
    - indexPreTxHex
    - metaId
    - path
    type: object
  controller_handler.CommitUploadRequest:
    properties:
      fileId:
        example: metaid_abc123
        type: string
      signedRawTx:
        example: 0100000...
        type: string
    required:
    - fileId
    - signedRawTx
    type: object
  controller_handler.CommitUploadResponseData:
    properties:
      fileId:
        example: metaid_abc123
        type: string
      message:
        example: success
        type: string
      pinId:
        example: abc123...i0
        type: string
      status:
        example: success
        type: string
      txId:
        example: abc123...
        type: string
    type: object
  controller_handler.ConfigResponse:
    properties:
      maxFileSize:
        example: 10485760
        type: integer
      swaggerBaseUrl:
        example: localhost:7282
        type: string
    type: object
  controller_handler.EstimateChunkedUploadRequest:
    properties:
      content:
        type: string
      contentType:
        example: image/jpeg
        type: string
      feeRate:
        example: 1
        type: integer
      fileName:
        example: example.jpg
        type: string
      path:
        example: /file
        type: string
    required:
    - content
    - fileName
    - path
    type: object
  controller_handler.PreUploadResponseData:
    properties:
      calTxFee:
        example: 1000
        type: integer
      calTxSize:
        example: 500
        type: integer
      fileId:
        example: metaid_abc123
        type: string
      fileMd5:
        example: 5d41402abc4b2a76b9719d911017c592
        type: string
      filehash:
        example: 2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae
        type: string
      message:
        example: success
        type: string
      pinId:
        example: abc123...i0
        type: string
      preTxRaw:
        example: 0100000...
        type: string
      status:
        example: pending
        type: string
      txId:
        example: abc123...
        type: string
    type: object
  meta-file-system_controller_respond.Response:
    description: Unified API response structure
    properties:
      code:
        example: 0
        type: integer
      data: {}
      message:
        example: success
        type: string
      processingTime:
        example: 123
        type: integer
    type: object
  meta-file-system_service_upload_service.ChunkedUploadResponse:
    properties:
      chunkFundingTx:
        description: 托管地址充值交易（构建完成，可直接签名/广播）
        type: string
      chunkNumber:
        description: 分片数量
        type: integer
      chunkTxIds:
        description: Chunk 交易 ID 列表（按顺序）
        items:
          type: string
        type: array
      chunkTxs:
        description: Chunk 交易 hex 列表（按顺序）
        items:
          type: string
        type: array
      fileHash:
        description: 文件 SHA256 hash
        type: string
      fileId:
        description: 文件 ID
        type: string
      fileMd5:
        description: 文件 MD5 hash
        type: string
      indexTx:
        description: Index 交易 hex
        type: string
      indexTxId:
        description: Index 交易 ID
        type: string
      message:
        description: 消息
        type: string
      status:
        description: 状态
        type: string
    type: object
  meta-file-system_service_upload_service.EstimateChunkedUploadResponse:
    properties:
      chunkFees:
        description: 每个 chunk 的费用
        items:
          type: integer
        type: array
      chunkNumber:
        description: 分片数量
        type: integer
      chunkPerTxFee:
        description: 每个 chunk 的费用
        type: integer
      chunkPreTxFee:
        description: ChunkPreTxHex 需要的总费用（所有 chunk 费用之和）
        type: integer
      chunkSize:
        description: 分片大小（字节）
        type: integer
      indexPreTxFee:
        description: IndexPreTxHex 需要的费用
        type: integer
      message:
        description: 消息
        type: string
      perChunkFee:
        description: 每个 chunk 的平均费用
        type: integer
      totalFee:
        description: 总费用（ChunkPreTxFee + IndexPreTxFee）
        type: integer
    type: object
host: localhost:7282
info:
  contact:
    email: support@swagger.io
    name: API Support
    url: http://www.swagger.io/support
  description: Meta File System Upload Service API, provides file upload functionality
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: Meta File System Uploader API
  version: "1.0"
paths:
  /config:
    get:
      consumes:
      - application/json
      description: Get upload service configuration information, including max file
        size and swagger base URL
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.ConfigResponse'
              type: object
      summary: Get configuration
      tags:
      - Configuration
  /files/chunked-upload:
    post:
      consumes:
      - application/json
      description: Upload large file by splitting it into chunks, build transactions
        for chunks and index, optionally broadcast all transactions in order
      parameters:
      - description: Chunked upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.ChunkedUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Upload successful
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.ChunkedUploadResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Chunked file upload
      tags:
      - File Upload
  /files/commit-upload:
    post:
      consumes:
      - application/json
      description: Submit signed transaction for broadcast
      parameters:
      - description: Commit upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.CommitUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Upload successful, return transaction ID and Pin ID
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.CommitUploadResponseData'
              type: object
        "400":
          description: Parameter error or file not found
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error or broadcast failed
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Commit upload
      tags:
      - File Upload
  /files/direct-upload:
    post:
      consumes:
      - multipart/form-data
      description: Upload file and add MetaID OP_RETURN output to existing PreTxHex,
        then broadcast immediately. This is a one-step upload process that combines
        building and broadcasting. Supports UTXO merge transaction for SIGHASH_SINGLE
        compatibility.
      parameters:
      - description: File to upload
        in: formData
        name: file
        required: true
        type: file
      - description: File path
        in: formData
        name: path
        required: true
        type: string
      - description: Pre-transaction hex (signed, with inputs and outputs)
        in: formData
        name: preTxHex
        required: true
        type: string
      - description: Merge transaction hex (optional, broadcasted before main transaction)
        in: formData
        name: mergeTxHex
        type: string
      - default: create
        description: Operation type
        in: formData
        name: operation
        type: string
      - description: Content type
        in: formData
        name: contentType
        type: string
      - description: MetaID
        in: formData
        name: metaId
        type: string
      - description: Address (also used as change address if changeAddress is not
          provided)
        in: formData
        name: address
        type: string
      - description: Change address (optional, defaults to address)
        in: formData
        name: changeAddress
        type: string
      - description: Fee rate (satoshis per byte, optional)
        in: formData
        name: feeRate
        type: integer
      - description: Total input amount in satoshis (optional, for automatic change
          calculation)
        in: formData
        name: totalInputAmount
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Upload successful, return transaction ID and Pin ID
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.CommitUploadResponseData'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Direct upload file (one-step)
      tags:
      - File Upload
  /files/estimate-chunked-upload:
    post:
      consumes:
      - application/json
      description: Estimate the fee required for chunked file upload, including chunk
        count and fees for ChunkPreTxHex and IndexPreTxHex
      parameters:
      - description: Estimate chunked upload request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller_handler.EstimateChunkedUploadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Estimate successful
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/meta-file-system_service_upload_service.EstimateChunkedUploadResponse'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Estimate chunked upload fee
      tags:
      - File Upload
  /files/pre-upload:
    post:
      consumes:
      - multipart/form-data
      description: Upload file and generate unsigned transaction, return transaction
        for client signing
      parameters:
      - description: File to upload
        in: formData
        name: file
        required: true
        type: file
      - description: File path
        in: formData
        name: path
        required: true
        type: string
      - default: create
        description: Operation type
        in: formData
        name: operation
        type: string
      - description: Content type
        in: formData
        name: contentType
        type: string
      - description: Change address
        in: formData
        name: changeAddress
        type: string
      - description: MetaID
        in: formData
        name: metaId
        type: string
      - description: Address
        in: formData
        name: address
        type: string
      - default: 1
        description: Fee rate
        in: formData
        name: feeRate
        type: integer
      - description: Output list json
        in: formData
        name: outputs
        type: string
      - description: Other output list json
        in: formData
        name: otherOutputs
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Pre-upload successful, return transaction and file info
          schema:
            allOf:
            - $ref: '#/definitions/meta-file-system_controller_respond.Response'
            - properties:
                data:
                  $ref: '#/definitions/controller_handler.PreUploadResponseData'
              type: object
        "400":
          description: Parameter error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
        "500":
          description: Server error
          schema:
            $ref: '#/definitions/meta-file-system_controller_respond.Response'
      summary: Pre-upload file
      tags:
      - File Upload
schemes:
- https
- http
swagger: "2.0"
